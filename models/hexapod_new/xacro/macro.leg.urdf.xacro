<?xml version="1.0"?>
<robot xmlns:xacro="http://www.ros.org/wiki/xacro">


    <xacro:include filename="$(find hex)/models/hexapod_new/xacro/macro.transmission.xacro"/>
    <xacro:include filename="$(find hex)/models/hexapod_new/xacro/macro.internal_config.xacro"/>


    <material name="coxa">
        <color rgba="0.5 0 0.5 1"/>
    </material> 

    <material name="femur">
        <color rgba="0.5 0 0.5 1"/>

    </material>

    <material name="tibia">
        <color rgba="0.5 0 0.5 1"/>
    </material> 

    <xacro:macro name="leg" params="legnumber xyz rpy">

        <link name="coxa_${legnumber}">
            <visual>
            <geometry>
                <mesh filename="package://hex/models/hexapod_new/meshes/new_meshe/coxa.stl" scale="0.01 0.01 0.01"/>
            </geometry>
            <origin xyz="0 0 0"/>
            <material name="coxa"/>
            </visual>
            <inertial>
              <xacro:box_inertia m="${coxa_mass}" x="0.15" y="0.5" z="0.5"/>
            </inertial>
            <collision>
            <geometry>
                <mesh filename="package://hex/models/hexapod_new/meshes/new_meshe/coxa.stl" scale="0.01 0.01 0.01"/>
                <origin xyz="0 0 0"/>
            </geometry>
            </collision> 
        </link>

        <link name="femur_${legnumber}">
            <visual>
            <geometry>
                <mesh filename="package://hex/models/hexapod_new/meshes/new_meshe/femur.stl" scale="0.01 0.01 0.01"/>
            </geometry>
            <origin xyz="0 0 0"/>
            <material name="femur"/>
            </visual>
            <inertial>
                 <xacro:box_inertia m="${femur_mass}" x="0.45" y="0.72" z="0.17"/>
            </inertial>
            <collision>
            <geometry>
                <mesh filename="package://hex/models/hexapod_new/meshes/new_meshe/femur.stl" scale="0.01 0.01 0.01"/>
                <origin xyz="0 0 0"/>
            </geometry>
            </collision> 
        </link>

        <link name="tibia_${legnumber}">
            <visual>
            <geometry>
                <mesh filename="package://hex/models/hexapod_new/meshes/new_meshe/tibia.stl" scale="0.01 0.01 0.01"/>
            </geometry>
            <origin xyz="0 0 0"/>
            <material name="tibia"/>
            </visual>
            <inertial>
                <xacro:box_inertia m="${femur_mass}" x="0.3" y="1.15" z="0.22"/>
            </inertial>
            <collision>
            <geometry>
                <mesh filename="package://hex/models/hexapod_new/meshes/new_meshe/tibia.stl" scale="0.01 0.01 0.01"/>
                <origin xyz="0 0 0"/>
            </geometry>
            </collision>
        </link>

        <joint name="base_coxa_joint_${legnumber}" type="revolute">
            <parent link="body_bottom"/>
            <child link="coxa_${legnumber}"/>
            <origin rpy="${rpy}" xyz="${xyz}"/>
            <limit effort="${base_coxa_effort}" lower="${lower_bc}" upper="${upper_bc}" velocity="${base_coxa_velocity}"/>
            <axis xyz="0 0 1"/>
            <dynamics damping="${base_coxa_damping}" friction="${base_coxa_friction}"/>
        </joint>
         
        <joint name="coxa_femur_joint_${legnumber}" type="revolute">
            <parent link="coxa_${legnumber}"/>
            <child link="femur_${legnumber}"/>
            <origin rpy="0.0 0.0 0.0" xyz="0.09 -0.345 -0.04"/>
            <limit effort="${coxa_femur_effort}" lower="${lower_cf}" upper="${upper_cf}" velocity="${coxa_femur_velocity}"/>
            <axis xyz="1 0 0"/>
            <dynamics damping="${coxa_femur_damping}" friction="${coxa_femur_friction}"/>
        </joint>

        <joint name="femur_tibia_joint_${legnumber}" type="revolute">
            <parent link="femur_${legnumber}"/>
            <child link="tibia_${legnumber}"/>
            <origin rpy="0 0.0 0.0" xyz="-0.035 -0.555 0.0"/>
            <limit effort="${femur_tibia_effort}" lower="${lower_ft}" upper="${upper_ft}" velocity="${femur_tibia_velocity}"/>
            <axis xyz="1 0 0"/>
            <dynamics damping="${femur_tibia_damping}" friction="${femur_tibia_friction}"/>
        </joint>

    	<xacro:leg_transmissions legnumber="${legnumber}"/>
        <xacro:dsr_config_coeff legnumber="${legnumber}"/>
    </xacro:macro>


</robot>